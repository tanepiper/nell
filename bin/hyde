#!/usr/bin/env node
'use strict';
var argv = require('optimist')
          .usage('Usage: hyde generate [options]')
          .argv;
//console.log(argv);

if (argv._[0] === 'newsite') {
  var name = (argv._[1]) ? argv._[1] : 'hyde-site';
  var current_path = process.cwd();

  require(__dirname + '/../lib/newsite')(current_path, name, {}, function(err) {
    if (err) {
      process.stderr.write(err.message);
    } else {
      process.stdout.write('Site ' + name + ' created in ' + current_path);
    }
  });
}

if (argv._[0] === 'preview') {
  var current_path = process.cwd();
  require(__dirname + '/../lib/preview')(current_path + '/output');
}


if (argv._[0] === 'generate') {
  var current_path = process.cwd();
  var config = require(current_path + '/hyde.json');

  require(__dirname + '/../lib/generate')(current_path, config, function(err) {
    if (err) {
      process.stderr.write(err.message);
    } else {
      process.stdout.write('Site ' + name + ' generated in ' + current_path);
    }
  });
}
